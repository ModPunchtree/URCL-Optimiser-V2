BITS 16
MINREG 4
@DEFINE a R1
@DEFINE b R2
@DEFINE c R3
@DEFINE result R4
.loop
IN a %FIXED
OUT %FIXED a
OUT %TEXT '/'
IN b %FIXED
OUT %FIXED b
OUT %TEXT '='
HCAL .fixed_div
OUT %FIXED result
OUT %TEXT '\n'
JMP .loop

.fixed_div
XOR c a b
AND c c 0x8000
HPSH c
AND a a 0x7FFF
AND b b 0x7FFF
LSH a a
DIV result a b
MOD a a b
BSL a a 1
BSL result result 1
DIV c a b
ADD result result c
MOD a a b
BSL a a 1
BSR b b 1
BSL result result 2
DIV c a b
ADD result result c
MOD a a b
BSL a a 3
BSR b b 1
BSL result result 4
DIV c a b
ADD result result c
MOD a a b
LSH a a
SETG a a b
SUB result result a
HPOP c
OR result result c
HRET